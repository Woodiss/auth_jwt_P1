{% extends 'base.html.twig' %}

{% block title %}Vérification à deux facteurs{% endblock %}

{% block content %}
  <h1>Vérification à deux facteurs</h1>

  {% if method == 'TOTP' %}
    <p>Veuillez entrer le code à 6 chiffres affiché dans votre application d’authentification (Google Authenticator, Authy, etc.).</p>
  {% elseif method == 'EMAIL' %}
    <p>Un code à usage unique vous a été envoyé par e-mail. Veuillez le saisir ci-dessous :</p>
  {% else %}
    <p>Aucune méthode d’authentification configurée.</p>
  {% endif %}

  {% if errors.code %}
    <p style="color:red;">{{ errors.code }}</p>
  {% endif %}

  <form method="post" action="{{ basePath }}/mfa/verify" style="margin-top: 1rem;">
      <label for="code">Code à 6 chiffres :</label><br>
      <input type="text"
             id="code"
             name="code"
             maxlength="6"
             pattern="[0-9]{6}"
             inputmode="numeric"
             required
             style="padding:0.4rem; margin-top:0.5rem;">

      <div style="margin-top:1rem;">
          <button type="submit">Valider</button>
      </div>
  </form>

  <p style="margin-top:1.5rem;">
    <a href="{{ basePath }}/login">← Retour à la connexion</a>
  </p>
{% endblock %}
