{% extends 'base.html.twig' %}

{% block title %}Vérification 2FA{% endblock %}

{% block content %}
<div class="login-2fa-container">
    <h2>Vérification en deux étapes</h2>

    {% if errors.otp %}
        <p class="error">{{ errors.otp }}</p>
    {% endif %}

    <p>
        {% if user.twoFactorMethod == 'totp' %}
            Entrez le code affiché dans votre application Google Authenticator.
        {% elseif user.twoFactorMethod == 'email' %}
            Nous avons envoyé un code à votre adresse email : <strong>{{ user.email }}</strong>.
        {% elseif user.twoFactorMethod == 'sms' %}
            Nous avons envoyé un code par SMS au numéro : <strong>{{ user.phone }}</strong>.
        {% endif %}
    </p>

    <form method="post" action="{{ basePath }}/login">
        <label for="otp">Code :</label>
        <input type="text" id="otp" name="otp" maxlength="6" required>
        <button type="submit">Valider</button>
    </form>

    <p><a href="{{ basePath }}/login">Retour à la connexion</a></p>
</div>
{% endblock %}

